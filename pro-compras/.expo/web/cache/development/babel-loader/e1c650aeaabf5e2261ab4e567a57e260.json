{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { size, map, filter } from \"lodash\";\nimport { CART, API_URL } from \"../utils/constants\";\nexport function getProductCartApi() {\n  var cart;\n  return _regeneratorRuntime.async(function getProductCartApi$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          _context.prev = 0;\n          _context.next = 3;\n          return _regeneratorRuntime.awrap(AsyncStorage.getItem(CART));\n\n        case 3:\n          cart = _context.sent;\n\n          if (cart) {\n            _context.next = 6;\n            break;\n          }\n\n          return _context.abrupt(\"return\", []);\n\n        case 6:\n          return _context.abrupt(\"return\", JSON.parse(cart));\n\n        case 9:\n          _context.prev = 9;\n          _context.t0 = _context[\"catch\"](0);\n          return _context.abrupt(\"return\", null);\n\n        case 12:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, [[0, 9]], Promise);\n}\nexport function addProductCartApi(idProduct, quantity) {\n  var cart, found;\n  return _regeneratorRuntime.async(function addProductCartApi$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          _context2.prev = 0;\n          _context2.next = 3;\n          return _regeneratorRuntime.awrap(getProductCartApi());\n\n        case 3:\n          cart = _context2.sent;\n\n          if (size(cart) === 0) {\n            cart.push({\n              idProduct: idProduct,\n              quantity: quantity\n            });\n          } else {\n            found = false;\n            map(cart, function (product) {\n              if (product.idProduct === idProduct) {\n                product.quantity += quantity;\n                found = true;\n                return product;\n              }\n            });\n\n            if (!found) {\n              cart.push({\n                idProduct: idProduct,\n                quantity: quantity\n              });\n            }\n          }\n\n          _context2.next = 7;\n          return _regeneratorRuntime.awrap(AsyncStorage.setItem(CART, JSON.stringify(cart)));\n\n        case 7:\n          return _context2.abrupt(\"return\", true);\n\n        case 10:\n          _context2.prev = 10;\n          _context2.t0 = _context2[\"catch\"](0);\n          return _context2.abrupt(\"return\", false);\n\n        case 13:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, null, null, [[0, 10]], Promise);\n}\nexport function deleteProductCartApi(idProduct) {\n  var cart, newCart;\n  return _regeneratorRuntime.async(function deleteProductCartApi$(_context3) {\n    while (1) {\n      switch (_context3.prev = _context3.next) {\n        case 0:\n          _context3.prev = 0;\n          _context3.next = 3;\n          return _regeneratorRuntime.awrap(getProductCartApi());\n\n        case 3:\n          cart = _context3.sent;\n          newCart = filter(cart, function (product) {\n            return product.idProduct !== idProduct;\n          });\n          _context3.next = 7;\n          return _regeneratorRuntime.awrap(AsyncStorage.setItem(CART, JSON.stringify(newCart)));\n\n        case 7:\n          return _context3.abrupt(\"return\", true);\n\n        case 10:\n          _context3.prev = 10;\n          _context3.t0 = _context3[\"catch\"](0);\n          return _context3.abrupt(\"return\", null);\n\n        case 13:\n        case \"end\":\n          return _context3.stop();\n      }\n    }\n  }, null, null, [[0, 10]], Promise);\n}\nexport function decreaseProductCartApi(idProduct) {\n  var isDelete, cart;\n  return _regeneratorRuntime.async(function decreaseProductCartApi$(_context4) {\n    while (1) {\n      switch (_context4.prev = _context4.next) {\n        case 0:\n          isDelete = false;\n          _context4.prev = 1;\n          _context4.next = 4;\n          return _regeneratorRuntime.awrap(getProductCartApi());\n\n        case 4:\n          cart = _context4.sent;\n          map(cart, function (product) {\n            if (product.idProduct === idProduct) {\n              if (product.quantity === 1) {\n                isDelete = true;\n                return null;\n              } else {\n                return product.quantity -= 1;\n              }\n            }\n          });\n\n          if (!isDelete) {\n            _context4.next = 11;\n            break;\n          }\n\n          _context4.next = 9;\n          return _regeneratorRuntime.awrap(deleteProductCartApi(idProduct));\n\n        case 9:\n          _context4.next = 13;\n          break;\n\n        case 11:\n          _context4.next = 13;\n          return _regeneratorRuntime.awrap(AsyncStorage.setItem(CART, JSON.stringify(cart)));\n\n        case 13:\n          return _context4.abrupt(\"return\", true);\n\n        case 16:\n          _context4.prev = 16;\n          _context4.t0 = _context4[\"catch\"](1);\n          return _context4.abrupt(\"return\", null);\n\n        case 19:\n        case \"end\":\n          return _context4.stop();\n      }\n    }\n  }, null, null, [[1, 16]], Promise);\n}\nexport function increaseProductCartApi(idProduct) {\n  var cart;\n  return _regeneratorRuntime.async(function increaseProductCartApi$(_context5) {\n    while (1) {\n      switch (_context5.prev = _context5.next) {\n        case 0:\n          _context5.prev = 0;\n          _context5.next = 3;\n          return _regeneratorRuntime.awrap(getProductCartApi());\n\n        case 3:\n          cart = _context5.sent;\n          map(cart, function (product) {\n            if (product.idProduct === idProduct) {\n              return product.quantity += 1;\n            }\n          });\n          _context5.next = 7;\n          return _regeneratorRuntime.awrap(AsyncStorage.setItem(CART, JSON.stringify(cart)));\n\n        case 7:\n          return _context5.abrupt(\"return\", true);\n\n        case 10:\n          _context5.prev = 10;\n          _context5.t0 = _context5[\"catch\"](0);\n          return _context5.abrupt(\"return\", null);\n\n        case 13:\n        case \"end\":\n          return _context5.stop();\n      }\n    }\n  }, null, null, [[0, 10]], Promise);\n}\nexport function paymentCartApi(auth, tokenStripe, products, address) {\n  var addressShipping, url, params, result;\n  return _regeneratorRuntime.async(function paymentCartApi$(_context6) {\n    while (1) {\n      switch (_context6.prev = _context6.next) {\n        case 0:\n          _context6.prev = 0;\n          addressShipping = address;\n          delete addressShipping.user;\n          delete addressShipping.createdAt;\n          url = API_URL + \"/orders\";\n          params = {\n            method: \"POST\",\n            headers: {\n              \"Content-Type\": \"application/json\",\n              Authorization: \"Bearer \" + auth.token\n            },\n            body: JSON.stringify({\n              tokenStripe: tokenStripe,\n              products: products,\n              idUser: auth.idUser,\n              addressShipping: addressShipping\n            })\n          };\n          _context6.next = 8;\n          return _regeneratorRuntime.awrap(fetch(url, params));\n\n        case 8:\n          result = _context6.sent;\n          return _context6.abrupt(\"return\", result);\n\n        case 12:\n          _context6.prev = 12;\n          _context6.t0 = _context6[\"catch\"](0);\n          console.log(_context6.t0);\n          return _context6.abrupt(\"return\", null);\n\n        case 16:\n        case \"end\":\n          return _context6.stop();\n      }\n    }\n  }, null, null, [[0, 12]], Promise);\n}\nexport function deleteCartApi() {\n  return _regeneratorRuntime.async(function deleteCartApi$(_context7) {\n    while (1) {\n      switch (_context7.prev = _context7.next) {\n        case 0:\n          _context7.prev = 0;\n          _context7.next = 3;\n          return _regeneratorRuntime.awrap(AsyncStorage.removeItem(CART));\n\n        case 3:\n          return _context7.abrupt(\"return\", true);\n\n        case 6:\n          _context7.prev = 6;\n          _context7.t0 = _context7[\"catch\"](0);\n          return _context7.abrupt(\"return\", null);\n\n        case 9:\n        case \"end\":\n          return _context7.stop();\n      }\n    }\n  }, null, null, [[0, 6]], Promise);\n}","map":{"version":3,"sources":["C:/Users/Patricia/Desktop/Nueva carpeta/pro-compras/src/api/cart.js"],"names":["AsyncStorage","size","map","filter","CART","API_URL","getProductCartApi","getItem","cart","JSON","parse","addProductCartApi","idProduct","quantity","push","found","product","setItem","stringify","deleteProductCartApi","newCart","decreaseProductCartApi","isDelete","increaseProductCartApi","paymentCartApi","auth","tokenStripe","products","address","addressShipping","user","createdAt","url","params","method","headers","Authorization","token","body","idUser","fetch","result","console","log","deleteCartApi","removeItem"],"mappings":"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","sourcesContent":["import AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { size, map, filter } from \"lodash\";\nimport { CART, API_URL } from \"../utils/constants\";\n\nexport async function getProductCartApi() {\n  try {\n    const cart = await AsyncStorage.getItem(CART);\n    if (!cart) return [];\n    return JSON.parse(cart);\n  } catch (e) {\n    return null;\n  }\n}\n\nexport async function addProductCartApi(idProduct, quantity) {\n  try {\n    const cart = await getProductCartApi();\n\n    if (size(cart) === 0) {\n      cart.push({\n        idProduct,\n        quantity,\n      });\n    } else {\n      let found = false;\n\n      map(cart, (product) => {\n        if (product.idProduct === idProduct) {\n          product.quantity += quantity;\n          found = true;\n          return product;\n        }\n      });\n\n      if (!found) {\n        cart.push({\n          idProduct,\n          quantity,\n        });\n      }\n    }\n\n    await AsyncStorage.setItem(CART, JSON.stringify(cart));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nexport async function deleteProductCartApi(idProduct) {\n  try {\n    const cart = await getProductCartApi();\n    const newCart = filter(cart, (product) => {\n      return product.idProduct !== idProduct;\n    });\n    await AsyncStorage.setItem(CART, JSON.stringify(newCart));\n    return true;\n  } catch (e) {\n    return null;\n  }\n}\n\nexport async function decreaseProductCartApi(idProduct) {\n  let isDelete = false;\n\n  try {\n    const cart = await getProductCartApi();\n    map(cart, (product) => {\n      if (product.idProduct === idProduct) {\n        if (product.quantity === 1) {\n          isDelete = true;\n          return null;\n        } else {\n          return (product.quantity -= 1);\n        }\n      }\n    });\n\n    if (isDelete) {\n      await deleteProductCartApi(idProduct);\n    } else {\n      await AsyncStorage.setItem(CART, JSON.stringify(cart));\n    }\n\n    return true;\n  } catch (e) {\n    return null;\n  }\n}\n\nexport async function increaseProductCartApi(idProduct) {\n  try {\n    const cart = await getProductCartApi();\n    map(cart, (product) => {\n      if (product.idProduct === idProduct) {\n        return (product.quantity += 1);\n      }\n    });\n\n    await AsyncStorage.setItem(CART, JSON.stringify(cart));\n    return true;\n  } catch (e) {\n    return null;\n  }\n}\n\nexport async function paymentCartApi(auth, tokenStripe, products, address) {\n  try {\n    const addressShipping = address;\n    delete addressShipping.user;\n    delete addressShipping.createdAt;\n\n    const url = `${API_URL}/orders`;\n    const params = {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${auth.token}`,\n      },\n      body: JSON.stringify({\n        tokenStripe,\n        products,\n        idUser: auth.idUser,\n        addressShipping,\n      }),\n    };\n    const result = await fetch(url, params);\n    return result;\n  } catch (error) {\n    console.log(error);\n    return null;\n  }\n}\n\nexport async function deleteCartApi() {\n  try {\n    await AsyncStorage.removeItem(CART);\n    return true;\n  } catch (e) {\n    return null;\n  }\n}\n"]},"metadata":{},"sourceType":"module"}